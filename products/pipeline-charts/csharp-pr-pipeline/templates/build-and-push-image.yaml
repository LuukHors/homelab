{{- if and .Values.updateDockerImages.enabled .Values.pipeline.giteaSshPrivateKey }}
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  namespace: {{ .Values.pipeline.namespace }}
  name: {{ .Values.pipeline.name }}-csharp-build-and-push-images
spec:
  params:
  - name: SHEBANG
    description: |
      Python path. Depends on the image.
    type: string
    default: /usr/bin/env python

  volumes:
    - name: gitea-ssh-private-key
      secret: 
        secretName: {{ .Values.pipeline.name }}-ssh-key

  steps:
    - name: git-checkout-branch
      resources: {}
      volumeMounts:
        - name: gitea-ssh-private-key
          mountPath: /root/.ssh/id_rsa
      image: alpine/git:v2.49.0
      script: |
        cat <<EOF > ~/.ssh/config
        Host git.internal.sealeo.io
            HostName gitea-ssh.gitea.svc.cluster.local
            User git
            Port 22
            StrictHostKeyChecking no
        EOF

        git clone git@git.internal.sealeo.io:LuukHorsman/test.git
{{- end }}